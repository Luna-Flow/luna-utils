# 貢献ガイドライン

**NOTE**  
プロジェクトメンテナーの日本語レベルはそれほど高くないため、翻訳に誤りがある可能性があります。慎重に判断してください。この点についてご不便をおかけしますことをお詫び申し上げます。

## 目次
1. [コードスタイル](#1-コードスタイル)
2. [名前の命名規則](#2-名前の命名規則)  
   2.1 [変数の命名](#21-変数の命名)  
   2.2 [関数の命名](#22-関数の命名)  
   2.3 [ストラクトとトレイトの命名](#23-ストラクトとトレイトの命名)  
   2.4 [定数の命名](#24-定数の命名)  
   2.5 [結果エラーのエラーコードの設計](#25-結果エラーのエラーコードの設計)  
3. [コメント](#3-コメント)  
4. [ファイルの規格](#4-ファイルの規格)  
   - [フォルダ名の命名](#41-フォルダ名の命名)  
   - [ファイルの構成](#42-ファイルの構成)  
   - [`.mbti` ファイルの生成](#43-mbti-ファイルの生成)  
5. [コミット規則](#5-コミット規則)  
   - [コミットメッセージ](#51-コミットメッセージ)  
   - [コミットの頻度](#52-コミットの頻度)  
6. [コードレビュー](#5-コードレビュー)  

## 1. コードスタイル
<br>

本プロジェクトは MoonBit ツールチェインが採用するフォーマット規則に従う。以下のコマンドを実行してコードを自動でフォーマットすること。
```
moon fmt
```
コードの一貫性を保つために、コミット前に `moon fmt` を実行すること。

また、`ready_to_pr.sh` スクリプトを実行してコードのフォーマット、チェック、テストカバレッジファイルの生成、`.mbti` ファイルの生成を行うことも可能。
<br>

## 2. 名前の命名規則
<br>

### 2.1 変数の命名

小文字とアンダースコア（ `_` ）を使用（例: `my_var`）。

変数名は意味が明確で、用途が直感的に理解できるものにする。
<br>

### 2.2 関数の命名

小文字とアンダースコア（ `_` ）を使用（例: `calc_total_price()`）。

関数名は簡潔かつ説明的にし、機能が明確に分かるようにする。
<br>

### 2.3 ストラクトとトレイトの命名
パスカルケース（PascalCase）を使用（例: `MyStruct`, `MyTrait`）。

機能や役割を直感的に表す名前を使用し、抽象的すぎる名前は避ける。
<br>

### 2.4 定数の命名

小文字とアンダースコア（ `_` ）を使用（例: `machine_dbl_epsilon`）。

必要に応じてカテゴリーをプレフィックスとして付与（例: `machine_dbl_epsilon` は機械関連の定数）。

分かりやすく、簡潔な名前を付ける。
<br>

### 2.5 結果エラーのエラーコードの設計

大文字とアンダースコア（ `_` ）を使用（例: `E_MAX_ITER`）。

エラーコードには `E` をプレフィックスとして付与。

短く分かりやすいエラーコードを心掛ける。
<br>

## 3. コメント
<br>

簡潔さ：冗長にならず、明確に記述する。

一貫性：コード全体で統一された用語とスタイルを使用する。

明確さ：分かりやすい表現を用い、曖昧な表現や専門用語の多用を避ける。

正確さ：コードの動作や目的を正しく反映する。

最新状態の維持：コードの変更に応じてコメントを更新する。

開発者は MoonBit LSP の AI によるコードコメント生成機能を活用できるが、AI が生成したコメントは必ずレビューし、正確性を確認すること。
<br>

## 4. ファイルの規格
<br>

### 4.1 フォルダ名の命名
小文字のみを使用。

フォルダ名は簡潔かつ説明的にし、アンダースコア（ `_` ）で区切る。数字や特殊文字は避ける。

例：

微分関連の機能：`diff`

導関数関連の機能：`deriv`
<br>

### 4.2 ファイルの構成

ファイルは機能ごとに整理し、それぞれ特定の機能に焦点を当てる。

小文字とアンダースコア（ `_` ）を使用し、機能を明確に示す名前を付ける。

例：

`gauss_kronrod.mbt`: ガウス求積法（クロンスロッド拡張）を実装。

`adaptive_quadrature_gk.mbt`: ガウス求積法（クロンスロッド拡張）を用いた適応型求積法を実装。

注意：`utils.mbt` のような汎用的すぎる名前は避け、機能を明確に表す名前を使用すること。
<br>

## 5. コミット規則
<br>

### 5.1 コミットメッセージ
`ready_to_pr.sh` スクリプトを実行し、コードフォーマット、チェック、テストカバレッジ生成、`.mbti` ファイル生成を行うこと。

コミットごとに変更内容を明確に記述する。

コミットメッセージは英語で、簡潔かつ明確に記述する。

`fix:`, `feat:`, `refactor:`, `doc:` などのプレフィックスを使用。

例：
```
fix: fix bug in something
feat: add feature for something
refactor: refactor something
doc: add docs for something
```
<br>

### 5.2 コミットの頻度

コミットは小さく、一つの機能や修正に集中させる。

複数の変更を一つの大きなコミットにまとめないこと。
<br>

## 6. コードレビュー
<br>

`moon.mod.json` の依存関係やバージョンを変更する前に、メンテナーまたはコラボレーターに確認すること。

すべてのコードはコードレビューを受ける必要がある。

コードレビューでは、コードの品質、スタイル、パフォーマンス、セキュリティを重視する。

レビュアーは建設的なフィードバックを提供し、コードの改善に努める。